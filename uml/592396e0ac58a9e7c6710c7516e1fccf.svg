<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="560px" preserveAspectRatio="none" style="width:1212px;height:560px;" version="1.1" viewBox="0 0 1212 560" width="1212px" zoomAndPan="magnify"><defs><filter height="300%" id="foc5u5mi24ik7" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[be996cdb8e6bf2fc7cb89c555f2cd144]
class Entity--><rect codeLine="2" fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="60.8047" id="Entity" style="stroke:#A80036;stroke-width:1.5;" width="270" x="211" y="30"/><ellipse cx="324.25" cy="46" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M327.2188,51.6406 Q326.6406,51.9375 326,52.0781 Q325.3594,52.2344 324.6563,52.2344 Q322.1563,52.2344 320.8281,50.5938 Q319.5156,48.9375 319.5156,45.8125 Q319.5156,42.6875 320.8281,41.0313 Q322.1563,39.375 324.6563,39.375 Q325.3594,39.375 326,39.5313 Q326.6563,39.6875 327.2188,39.9844 L327.2188,42.7031 Q326.5938,42.125 326,41.8594 Q325.4063,41.5781 324.7813,41.5781 Q323.4375,41.5781 322.75,42.6563 Q322.0625,43.7188 322.0625,45.8125 Q322.0625,47.9063 322.75,48.9844 Q323.4375,50.0469 324.7813,50.0469 Q325.4063,50.0469 326,49.7813 Q326.5938,49.5 327.2188,48.9219 L327.2188,51.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="35" x="344.75" y="50.1543">Entity</text><line style="stroke:#A80036;stroke-width:1.5;" x1="212" x2="480" y1="62" y2="62"/><line style="stroke:#A80036;stroke-width:1.5;" x1="212" x2="480" y1="70" y2="70"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="217" y="84.2104">virtual void onSimulation(SimTime deltaTime)</text><!--MD5=[4bc2d5cfc8951b371a1d58c1ec96b9a3]
class MarkerEntity--><rect fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="48" id="MarkerEntity" style="stroke:#A80036;stroke-width:1.5;" width="110" x="168" y="256.5"/><ellipse cx="183" cy="272.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M185.9688,278.1406 Q185.3906,278.4375 184.75,278.5781 Q184.1094,278.7344 183.4063,278.7344 Q180.9063,278.7344 179.5781,277.0938 Q178.2656,275.4375 178.2656,272.3125 Q178.2656,269.1875 179.5781,267.5313 Q180.9063,265.875 183.4063,265.875 Q184.1094,265.875 184.75,266.0313 Q185.4063,266.1875 185.9688,266.4844 L185.9688,269.2031 Q185.3438,268.625 184.75,268.3594 Q184.1563,268.0781 183.5313,268.0781 Q182.1875,268.0781 181.5,269.1563 Q180.8125,270.2188 180.8125,272.3125 Q180.8125,274.4063 181.5,275.4844 Q182.1875,276.5469 183.5313,276.5469 Q184.1563,276.5469 184.75,276.2813 Q185.3438,276 185.9688,275.4219 L185.9688,278.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="78" x="197" y="276.6543">MarkerEntity</text><line style="stroke:#A80036;stroke-width:1.5;" x1="169" x2="277" y1="288.5" y2="288.5"/><line style="stroke:#A80036;stroke-width:1.5;" x1="169" x2="277" y1="296.5" y2="296.5"/><!--MD5=[436ba0187411f86d5737396f286859e5]
class VisibleEntity--><rect fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="48" id="VisibleEntity" style="stroke:#A80036;stroke-width:1.5;" width="107" x="353.5" y="256.5"/><ellipse cx="368.5" cy="272.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M371.4688,278.1406 Q370.8906,278.4375 370.25,278.5781 Q369.6094,278.7344 368.9063,278.7344 Q366.4063,278.7344 365.0781,277.0938 Q363.7656,275.4375 363.7656,272.3125 Q363.7656,269.1875 365.0781,267.5313 Q366.4063,265.875 368.9063,265.875 Q369.6094,265.875 370.25,266.0313 Q370.9063,266.1875 371.4688,266.4844 L371.4688,269.2031 Q370.8438,268.625 370.25,268.3594 Q369.6563,268.0781 369.0313,268.0781 Q367.6875,268.0781 367,269.1563 Q366.3125,270.2188 366.3125,272.3125 Q366.3125,274.4063 367,275.4844 Q367.6875,276.5469 369.0313,276.5469 Q369.6563,276.5469 370.25,276.2813 Q370.8438,276 371.4688,275.4219 L371.4688,278.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="382.5" y="276.6543">VisibleEntity</text><line style="stroke:#A80036;stroke-width:1.5;" x1="354.5" x2="459.5" y1="288.5" y2="288.5"/><line style="stroke:#A80036;stroke-width:1.5;" x1="354.5" x2="459.5" y1="296.5" y2="296.5"/><!--MD5=[a7dbee07e052eb86863001789e78e586]
class GhostEntity--><rect codeLine="10" fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="86.4141" id="GhostEntity" style="stroke:#A80036;stroke-width:1.5;" width="270" x="7" y="453.5"/><ellipse cx="101.75" cy="469.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M104.7188,475.1406 Q104.1406,475.4375 103.5,475.5781 Q102.8594,475.7344 102.1563,475.7344 Q99.6563,475.7344 98.3281,474.0938 Q97.0156,472.4375 97.0156,469.3125 Q97.0156,466.1875 98.3281,464.5313 Q99.6563,462.875 102.1563,462.875 Q102.8594,462.875 103.5,463.0313 Q104.1563,463.1875 104.7188,463.4844 L104.7188,466.2031 Q104.0938,465.625 103.5,465.3594 Q102.9063,465.0781 102.2813,465.0781 Q100.9375,465.0781 100.25,466.1563 Q99.5625,467.2188 99.5625,469.3125 Q99.5625,471.4063 100.25,472.4844 Q100.9375,473.5469 102.2813,473.5469 Q102.9063,473.5469 103.5,473.2813 Q104.0938,473 104.7188,472.4219 L104.7188,475.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="72" x="122.25" y="473.6543">GhostEntity</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="276" y1="485.5" y2="485.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="13" y="499.7104">virtual void onSimulation(SimTime deltaTime)</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="8" x2="276" y1="506.3047" y2="506.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="250" x="13" y="520.5151">Implement trigger logic here and if object is</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="215" x="13" y="533.3198">dynamic, we can update state as well</text><!--MD5=[3c0854818714436cf6dd8b71d32f6d78]
class PhysicsEntity--><rect codeLine="17" fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="99.2188" id="PhysicsEntity" style="stroke:#A80036;stroke-width:1.5;" width="272" x="312" y="447"/><ellipse cx="403.25" cy="463" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M406.2188,468.6406 Q405.6406,468.9375 405,469.0781 Q404.3594,469.2344 403.6563,469.2344 Q401.1563,469.2344 399.8281,467.5938 Q398.5156,465.9375 398.5156,462.8125 Q398.5156,459.6875 399.8281,458.0313 Q401.1563,456.375 403.6563,456.375 Q404.3594,456.375 405,456.5313 Q405.6563,456.6875 406.2188,456.9844 L406.2188,459.7031 Q405.5938,459.125 405,458.8594 Q404.4063,458.5781 403.7813,458.5781 Q402.4375,458.5781 401.75,459.6563 Q401.0625,460.7188 401.0625,462.8125 Q401.0625,464.9063 401.75,465.9844 Q402.4375,467.0469 403.7813,467.0469 Q404.4063,467.0469 405,466.7813 Q405.5938,466.5 406.2188,465.9219 L406.2188,468.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="81" x="423.75" y="467.1543">PhysicsEntity</text><line style="stroke:#A80036;stroke-width:1.5;" x1="313" x2="583" y1="479" y2="479"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="318" y="493.2104">virtual void onSimulation(SimTime deltaTime)</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="313" x2="583" y1="499.8047" y2="499.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="242" x="318" y="514.0151">Update the position/rotation of object here</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="260" x="318" y="526.8198">Also, if Scene is in edit mode, we can disable</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="318" y="539.6245">the physics counterpart here.</text><!--MD5=[e4faacc5b8aef66b11ab0c816bbbc7f8]
class Scene--><rect codeLine="28" fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="107.2188" id="Scene" style="stroke:#A80036;stroke-width:1.5;" width="276" x="539" y="7"/><ellipse cx="653.25" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M656.2188,28.6406 Q655.6406,28.9375 655,29.0781 Q654.3594,29.2344 653.6563,29.2344 Q651.1563,29.2344 649.8281,27.5938 Q648.5156,25.9375 648.5156,22.8125 Q648.5156,19.6875 649.8281,18.0313 Q651.1563,16.375 653.6563,16.375 Q654.3594,16.375 655,16.5313 Q655.6563,16.6875 656.2188,16.9844 L656.2188,19.7031 Q655.5938,19.125 655,18.8594 Q654.4063,18.5781 653.7813,18.5781 Q652.4375,18.5781 651.75,19.6563 Q651.0625,20.7188 651.0625,22.8125 Q651.0625,24.9063 651.75,25.9844 Q652.4375,27.0469 653.7813,27.0469 Q654.4063,27.0469 655,26.7813 Q655.5938,26.5 656.2188,25.9219 L656.2188,28.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="673.75" y="27.1543">Scene</text><line style="stroke:#A80036;stroke-width:1.5;" x1="540" x2="814" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="241" x="545" y="53.2104">Array&lt;shared_ptr&lt;Entity&gt;&gt; m_entityArray</text><line style="stroke:#A80036;stroke-width:1.0;" x1="540" x2="814" y1="59.8047" y2="59.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="231" x="545" y="74.0151">virtual onSimulation(SimTime deltaTime)</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="540" x2="814" y1="80.6094" y2="80.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149" x="545" y="94.8198">for (entity : m_entityArray)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="232" x="577" y="107.6245">entity-&gt;onSimulation(m_time, deltaTime)</text><!--MD5=[e685322343ff13113ff87f299d6be5ac]
class PhysicsScene--><rect codeLine="37" fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="107.2188" id="PhysicsScene" style="stroke:#A80036;stroke-width:1.5;" width="243" x="555.5" y="227"/><ellipse cx="630.25" cy="243" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M633.2188,248.6406 Q632.6406,248.9375 632,249.0781 Q631.3594,249.2344 630.6563,249.2344 Q628.1563,249.2344 626.8281,247.5938 Q625.5156,245.9375 625.5156,242.8125 Q625.5156,239.6875 626.8281,238.0313 Q628.1563,236.375 630.6563,236.375 Q631.3594,236.375 632,236.5313 Q632.6563,236.6875 633.2188,236.9844 L633.2188,239.7031 Q632.5938,239.125 632,238.8594 Q631.4063,238.5781 630.7813,238.5781 Q629.4375,238.5781 628.75,239.6563 Q628.0625,240.7188 628.0625,242.8125 Q628.0625,244.9063 628.75,245.9844 Q629.4375,247.0469 630.7813,247.0469 Q631.4063,247.0469 632,246.7813 Q632.5938,246.5 633.2188,245.9219 L633.2188,248.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="85" x="650.75" y="247.1543">PhysicsScene</text><line style="stroke:#A80036;stroke-width:1.5;" x1="556.5" x2="797.5" y1="259" y2="259"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="139" x="561.5" y="273.2104">PurePhysics* m_physics</text><line style="stroke:#A80036;stroke-width:1.0;" x1="556.5" x2="797.5" y1="279.8047" y2="279.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="231" x="561.5" y="294.0151">virtual onSimulation(SimTime deltaTime)</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="556.5" x2="797.5" y1="300.6094" y2="300.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="561.5" y="314.8198">m_physics-&gt;simulate(deltaTime)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="181" x="561.5" y="327.6245">Scene::onSimulation(deltaTime)</text><!--MD5=[e3eb655a99c09819b1e3df3502356920]
class PurePhysics--><rect codeLine="45" fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="99.2188" id="PurePhysics" style="stroke:#A80036;stroke-width:1.5;" width="348" x="850" y="11"/><ellipse cx="982.25" cy="27" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M985.2188,32.6406 Q984.6406,32.9375 984,33.0781 Q983.3594,33.2344 982.6563,33.2344 Q980.1563,33.2344 978.8281,31.5938 Q977.5156,29.9375 977.5156,26.8125 Q977.5156,23.6875 978.8281,22.0313 Q980.1563,20.375 982.6563,20.375 Q983.3594,20.375 984,20.5313 Q984.6563,20.6875 985.2188,20.9844 L985.2188,23.7031 Q984.5938,23.125 984,22.8594 Q983.4063,22.5781 982.7813,22.5781 Q981.4375,22.5781 980.75,23.6563 Q980.0625,24.7188 980.0625,26.8125 Q980.0625,28.9063 980.75,29.9844 Q981.4375,31.0469 982.7813,31.0469 Q983.4063,31.0469 984,30.7813 Q984.5938,30.5 985.2188,29.9219 L985.2188,32.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="1002.75" y="31.1543">PurePhysics</text><line style="stroke:#A80036;stroke-width:1.5;" x1="851" x2="1197" y1="43" y2="43"/><line style="stroke:#A80036;stroke-width:1.5;" x1="851" x2="1197" y1="51" y2="51"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="212" x="856" y="65.2104">insertEntity(const G3D::Entity *entity)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="224" x="856" y="78.0151">removeEntity(const G3D::Entity *entity)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="336" x="856" y="90.8198">G3D::CoordinateFrame getFrame(const G3D::Entity *entity)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="141" x="856" y="103.6245">simulate(float deltaTime)</text><!--MD5=[7d998290604532b21279e7f2b0117022]
class BulletPhysics--><rect codeLine="51" fill="#FEFECE" filter="url(#foc5u5mi24ik7)" height="212.8516" id="BulletPhysics" style="stroke:#A80036;stroke-width:1.5;" width="317" x="865.5" y="174"/><ellipse cx="979.25" cy="190" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M982.2188,195.6406 Q981.6406,195.9375 981,196.0781 Q980.3594,196.2344 979.6563,196.2344 Q977.1563,196.2344 975.8281,194.5938 Q974.5156,192.9375 974.5156,189.8125 Q974.5156,186.6875 975.8281,185.0313 Q977.1563,183.375 979.6563,183.375 Q980.3594,183.375 981,183.5313 Q981.6563,183.6875 982.2188,183.9844 L982.2188,186.7031 Q981.5938,186.125 981,185.8594 Q980.4063,185.5781 979.7813,185.5781 Q978.4375,185.5781 977.75,186.6563 Q977.0625,187.7188 977.0625,189.8125 Q977.0625,191.9063 977.75,192.9844 Q978.4375,194.0469 979.7813,194.0469 Q980.4063,194.0469 981,193.7813 Q981.5938,193.5 982.2188,192.9219 L982.2188,195.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="81" x="999.75" y="194.1543">BulletPhysics</text><line style="stroke:#A80036;stroke-width:1.5;" x1="866.5" x2="1181.5" y1="206" y2="206"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="209" x="871.5" y="220.2104">btDynamicsWorld *m_dynamicsWorld</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="196" x="871.5" y="233.0151">boost::bimap&lt;const G3D::Entity *,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="233" x="871.5" y="245.8198">btCollisionObject *&gt; m_dynamicBodyMap</text><line style="stroke:#A80036;stroke-width:1.0;" x1="866.5" x2="1181.5" y1="252.4141" y2="252.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="211" x="871.5" y="266.6245">insertEntity(const G3D::Entity *entity)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="221" x="871.5" y="279.4292">removeEntity(const G3D::Entity *entity)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="871.5" y="292.2339">simulate(float deltaTime)</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="866.5" x2="1181.5" y1="298.8281" y2="298.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="264" x="871.5" y="313.0386">m_dynamicsWorld-&gt;stepSimulation(deltaTime)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="866.5" x2="1181.5" y1="319.6328" y2="319.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="130" x="871.5" y="333.8433">G3D::CoordinateFrame</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="201" x="871.5" y="346.6479">getFrame(const G3D::Entity *entity)</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="866.5" x2="1181.5" y1="353.2422" y2="353.2422"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="305" x="871.5" y="367.4526">query m_dynamicBodyMap for object and get position</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="871.5" y="380.2573">from physics engine</text><!--MD5=[af0fd2c1db3865cc8e0cd223b13050ce]
reverse link Entity to MarkerEntity--><path codeLine="6" d="M319.3,108.83 C293.59,154.38 255.8,221.36 236.08,256.33 " fill="none" id="Entity-backto-MarkerEntity" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="313.23,105.33,329.16,91.35,325.42,112.21,313.23,105.33" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[38258fc6ee9e533f4e8c66080891ed8f]
reverse link Entity to VisibleEntity--><path codeLine="8" d="M359.76,110.66 C372.49,156.16 390.86,221.83 400.52,256.33 " fill="none" id="Entity-backto-VisibleEntity" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="353,112.5,354.35,91.35,366.48,108.73,353,112.5" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[ef79f93cae723d37bf85e809cd9d6349]
reverse link MarkerEntity to GhostEntity--><path codeLine="25" d="M207.02,323.71 C192.8,361.29 172.1,415.97 157.9,453.49 " fill="none" id="MarkerEntity-backto-GhostEntity" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="200.55,321.04,214.18,304.81,213.64,325.99,200.55,321.04" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[ffc55fb65a49d5f38fa0cf59166c9390]
reverse link VisibleEntity to PhysicsEntity--><path codeLine="26" d="M415.27,324.68 C422.05,360.05 431.63,410.06 438.68,446.84 " fill="none" id="VisibleEntity-backto-PhysicsEntity" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="408.35,325.77,411.47,304.81,422.1,323.13,408.35,325.77" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[9991c810c8d15e4a624bb46b43aa3134]
reverse link Scene to PhysicsScene--><path codeLine="69" d="M677,134.42 C677,164.67 677,199.11 677,226.84 " fill="none" id="Scene-backto-PhysicsScene" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="670,134.27,677,114.27,684,134.27,670,134.27" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[7bd1536576b2c518bd154c892b595b8a]
reverse link PurePhysics to BulletPhysics--><path codeLine="70" d="M1024,130.31 C1024,144.2 1024,159.1 1024,173.91 " fill="none" id="PurePhysics-backto-BulletPhysics" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1017,130.15,1024,110.15,1031,130.15,1017,130.15" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[56edb31f497dec7e49ec391455dc2d63]
@startuml

class Entity {
    virtual void onSimulation(SimTime deltaTime)
}

Entity <|- - MarkerEntity 

Entity <|- - VisibleEntity

class GhostEntity {
    virtual void onSimulation(SimTime deltaTime)
    ..
    Implement trigger logic here and if object is
    dynamic, we can update state as well
}

class PhysicsEntity {
    virtual void onSimulation(SimTime deltaTime)
    ..
    Update the position/rotation of object here
    Also, if Scene is in edit mode, we can disable
    the physics counterpart here.
}

MarkerEntity <|- - GhostEntity
VisibleEntity <|- - PhysicsEntity

class Scene {
    Array<shared_ptr<Entity>> m_entityArray
    - -
    virtual onSimulation(SimTime deltaTime)
    ..
    for (entity : m_entityArray)
    \tentity->onSimulation(m_time, deltaTime)
}

class PhysicsScene {
    PurePhysics* m_physics
    - -
    virtual onSimulation(SimTime deltaTime)
    ..
    m_physics->simulate(deltaTime)
    Scene::onSimulation(deltaTime)
}
class PurePhysics {
    {abstract} insertEntity(const G3D::Entity *entity)
    {abstract} removeEntity(const G3D::Entity *entity)
    {abstract} G3D::CoordinateFrame getFrame(const G3D::Entity *entity)
    {abstract} simulate(float deltaTime)
}
class BulletPhysics {
    btDynamicsWorld *m_dynamicsWorld
    boost::bimap<const G3D::Entity *, 
                 btCollisionObject *> m_dynamicBodyMap
    - -
    insertEntity(const G3D::Entity *entity)
    removeEntity(const G3D::Entity *entity)
    simulate(float deltaTime)
    ..
    m_dynamicsWorld->stepSimulation(deltaTime)
    - -
    G3D::CoordinateFrame 
    getFrame(const G3D::Entity *entity)
    ..
    query m_dynamicBodyMap for object and get position
    from physics engine
}

Scene <|- - PhysicsScene
PurePhysics <|- - BulletPhysics
      
@enduml

PlantUML version 1.2021.00(Sun Jan 10 15:55:05 IST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>